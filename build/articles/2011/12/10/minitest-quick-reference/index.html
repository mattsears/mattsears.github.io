<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if IE 8]> <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]> ><! <![endif]-->
<html class='no-js' lang='en'>
  <!-- <![endif] -->
  <head>
    <meta charset='utf-8' />
    <meta content='width=device-width, initial-scale=1.0' name='viewport' />
    <title>Matt Sears | Minitest Quick Reference</title>
    <meta content='Matt Sears, Matt, Sears' name='keywords' />
    <meta author='Matt Sears' />
    <link href='http://feeds.feedburner.com/mattsears' rel='alternate' title='Feed for mattsears' type='application/atom+xml' />
    <link href='/images/favicon.png' rel='shortcut icon' />
    <link href='/fonts/ss-social.css' rel='stylesheet' />
    <link href="/stylesheets/app.css?1357088081" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <nav>
      <div class='row'></div>
    </nav>
    <div class='row'>
      <div class='twelve columns centered'>
        <div class='row'>
  <div class='ten column centered'>
    <article>
      <header class='text-center'>
        <a href='/'>
          <img alt='Matt Sears' class='me' height='100' src='/images/matt-sears.png' title='Matt Sears' width='100' />
        </a>
        <h2>
          <a href='/articles/2011/12/10/minitest-quick-reference'>
            Minitest Quick Reference
          </a>
        </h2>
        <h5>
          Written by
          <a href='#'>Matt</a>
          on
          Dec 10
          /
          <span>
            <a class='dsq-comment-count comment-link commentslink' href='http://www.mattsears.com/articles/2011/12/10/minitest-quick-reference#disqus_thread'></a>
          </span>
        </h5>
      </header>
      <div class='row'>
        <div class='ten column centered'>
          <p><a href="https://github.com/seattlerb/minitest">MiniTest</a>, as the name suggests, is a
small and fast unit testing framework. Shipped with Ruby 1.9, MiniTest supports
a complete suite of testing capabilities such as TDD, BDD, mocking, and benchmarking.</p>

<p>This quick reference aims to demonstrate MiniTest&#39;s main concepts and
provide real world examples to get you acquainted quickly. Let&#39;s start with
MiniTest::Spec.</p>

<h3>MiniTest::Spec</h3>

<p>Provides RSpec-like matchers and contexts right out of the box.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;minitest/autorun&#39;</span>

<span class="n">describe</span> <span class="no">Hipster</span><span class="p">,</span> <span class="s2">&quot;Demonstration of MiniTest&quot;</span> <span class="k">do</span>
  <span class="n">before</span> <span class="k">do</span>
    <span class="vi">@hipster</span> <span class="o">=</span> <span class="no">Hipster</span><span class="o">.</span><span class="n">new</span>
  <span class="k">end</span>

  <span class="n">after</span> <span class="k">do</span>
    <span class="vi">@hipster</span><span class="o">.</span><span class="n">destroy!</span>
  <span class="k">end</span>

  <span class="n">subject</span> <span class="k">do</span>
    <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">attributes</span><span class="o">|</span>
      <span class="n">attributes</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;silly hats&quot;</span>
      <span class="n">attributes</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;skinny jeans&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">let</span><span class="p">(</span><span class="ss">:list</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span>

  <span class="n">describe</span> <span class="s2">&quot;when asked about the font&quot;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">&quot;should be helvetica&quot;</span> <span class="k">do</span>
      <span class="vi">@hipster</span><span class="o">.</span><span class="n">preferred_font</span><span class="o">.</span><span class="n">must_equal</span> <span class="s2">&quot;helvetica&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">describe</span> <span class="s2">&quot;when asked about mainstream&quot;</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">&quot;won&#39;t be mainstream&quot;</span> <span class="k">do</span>
      <span class="vi">@hipster</span><span class="o">.</span><span class="n">mainstream?</span><span class="o">.</span><span class="n">wont_equal</span> <span class="kp">true</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<h4>Matchers (must | wont)</h4>

<p>In most cases you can switch between <code>must</code> for positive expectations and <code>wont</code>
for negative expectations.</p>

<table><thead>
<tr>
<th align="left">Assertion</th>
<th align="left">Examples</th>
</tr>
</thead><tbody>
<tr>
<td align="left"><code>must_be</code></td>
<td align="left"><code>list.size.must_be :==, 0</code></td>
</tr>
<tr>
<td align="left"><code>must_be_close_to</code></td>
<td align="left"><code>subject.size.must_be_close_to 1,1</code></td>
</tr>
<tr>
<td align="left"><code>must_be_empty</code></td>
<td align="left"><code>list.must_be_empty</code></td>
</tr>
<tr>
<td align="left"><code>must_be_instance_of</code></td>
<td align="left"><code>list.must_be_instance_of Array</code></td>
</tr>
<tr>
<td align="left"><code>must_be_kind_of</code></td>
<td align="left"><code>list.must_be_kind_of Enumerable</code></td>
</tr>
<tr>
<td align="left"><code>must_be_nil</code></td>
<td align="left"><code>list.first.must_be_nil</code></td>
</tr>
<tr>
<td align="left"><code>must_be_same_as</code></td>
<td align="left"><code>subject.must_be_same_as subject</code></td>
</tr>
<tr>
<td align="left"><code>must_be_silent</code></td>
<td align="left"><code>proc { &quot;no stdout or stderr&quot; }.must_be_silent</code></td>
</tr>
<tr>
<td align="left"><code>must_be_within_epsilon</code></td>
<td align="left"><code>subject.size.must_be_within_epsilon 1,1</code></td>
</tr>
<tr>
<td align="left"><code>must_equal</code></td>
<td align="left"><code>subject.size.must_equal 2</code></td>
</tr>
<tr>
<td align="left"><code>must_include</code></td>
<td align="left"><code>subject.must_include &quot;skinny jeans&quot;</code></td>
</tr>
<tr>
<td align="left"><code>must_match</code></td>
<td align="left"><code>subject.first.must_match /silly/</code></td>
</tr>
<tr>
<td align="left"><code>must_output</code></td>
<td align="left"><code>proc { print &quot;#{subject.size}!&quot; }.must_output &quot;2!&quot;</code></td>
</tr>
<tr>
<td align="left"><code>must_respond_to</code></td>
<td align="left"><code>subject.must_respond_to :count</code></td>
</tr>
<tr>
<td align="left"><code>must_raise</code></td>
<td align="left"><code>proc { subject.foo }.must_raise NoMethodError</code></td>
</tr>
<tr>
<td align="left"><code>must_send</code></td>
<td align="left"><code>subject.must_send [subject, :values_at, 0]</code></td>
</tr>
<tr>
<td align="left"><code>must_throw</code></td>
<td align="left"><code>proc { throw :done if subject.any? }.must_throw :done</code></td>
</tr>
</tbody></table>

<h3>MiniTest::Unit::TestCase</h3>

<p>Provides a rich set of assertions to make your tests clean and readable.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;minitest/autorun&#39;</span>

<span class="k">class</span> <span class="nc">TestHipster</span> <span class="o">&lt;</span> <span class="ss">MiniTest</span><span class="p">:</span><span class="ss">:Unit</span><span class="o">::</span><span class="no">TestCase</span>
  <span class="k">def</span> <span class="nf">setup</span>
    <span class="vi">@hipster</span> <span class="o">=</span> <span class="no">Hipster</span><span class="o">.</span><span class="n">new</span>
    <span class="vi">@list</span>    <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span>
    <span class="vi">@subject</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;silly hats&quot;</span><span class="p">,</span> <span class="s2">&quot;skinny jeans&quot;</span><span class="o">]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">teardown</span>
    <span class="vi">@hipster</span><span class="o">.</span><span class="n">destroy!</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">test_for_helvetica_font</span>
    <span class="n">assert_equal</span> <span class="s2">&quot;helvetica!&quot;</span><span class="p">,</span> <span class="vi">@hipster</span><span class="o">.</span><span class="n">preferred_font</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">test_not_mainstream</span>
    <span class="n">refute</span> <span class="vi">@hipster</span><span class="o">.</span><span class="n">mainstream?</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<h4>Assertions (assert | refute)</h4>

<p>Toggle between <code>assert</code> for positive assertions and <code>refute</code> for negative assertions.</p>

<table><thead>
<tr>
<th align="left">Assertion</th>
<th align="left">Example</th>
</tr>
</thead><tbody>
<tr>
<td align="left"><code>assert</code></td>
<td align="left"><code>assert @subject.any?, &quot;empty subjects&quot;</code></td>
</tr>
<tr>
<td align="left"><code>assert_block</code></td>
<td align="left"><code>assert_block { @subject.any? }</code></td>
</tr>
<tr>
<td align="left"><code>assert_empty</code></td>
<td align="left"><code>assert_empty @list</code></td>
</tr>
<tr>
<td align="left"><code>assert_equal</code></td>
<td align="left"><code>assert_equal 2, @subject.size</code></td>
</tr>
<tr>
<td align="left"><code>assert_in_delta</code></td>
<td align="left"><code>assert_in_delta @subject.size, 1,1</code></td>
</tr>
<tr>
<td align="left"><code>assert_in_epsilon</code></td>
<td align="left"><code>assert_in_epsilon @subject.size, 1, 1</code></td>
</tr>
<tr>
<td align="left"><code>assert_includes</code></td>
<td align="left"><code>assert_includes @subject, &quot;skinny jeans&quot;</code></td>
</tr>
<tr>
<td align="left"><code>assert_instance_of</code></td>
<td align="left"><code>assert_instance_of Array, @list</code></td>
</tr>
<tr>
<td align="left"><code>assert_kind_of</code></td>
<td align="left"><code>assert_kind_of Enumerable, @list</code></td>
</tr>
<tr>
<td align="left"><code>assert_match</code></td>
<td align="left"><code>assert_match @subject.first, /silly/</code></td>
</tr>
<tr>
<td align="left"><code>assert_nil</code></td>
<td align="left"><code>assert_nil @list.first</code></td>
</tr>
<tr>
<td align="left"><code>assert_operator</code></td>
<td align="left"><code>assert_operator @list.size, :== , 0</code></td>
</tr>
<tr>
<td align="left"><code>assert_output</code></td>
<td align="left"><code>assert_output(&quot;Size: 2&quot;) { print &quot;Size: #{@subject.size}&quot;}</code></td>
</tr>
<tr>
<td align="left"><code>assert_raises</code></td>
<td align="left"><code>assert_raises(NoMethodError) { @subject.foo }</code></td>
</tr>
<tr>
<td align="left"><code>assert_respond_to</code></td>
<td align="left"><code>assert_respond_to @subject, :count</code></td>
</tr>
<tr>
<td align="left"><code>assert_same</code></td>
<td align="left"><code>assert_same @subject, @subject, &quot;It&#39;s the same object silly&quot;</code></td>
</tr>
<tr>
<td align="left"><code>assert_send</code></td>
<td align="left"><code>assert_send [@subject, :values_at, 0]</code></td>
</tr>
<tr>
<td align="left"><code>assert_silent</code></td>
<td align="left"><code>assert_silent { &quot;no stdout or stderr&quot; }</code></td>
</tr>
<tr>
<td align="left"><code>assert_throws</code></td>
<td align="left"><code>assert_throws(:error,&#39;is empty&#39;) {throw :error if @subject.any?}</code></td>
</tr>
</tbody></table>

<h2>MiniTest::Mock</h2>

<p>A simple and clean mock system. There two essential methods at our disposal:
<code>expect</code> and <code>verify</code>.</p>
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;minitest/autorun&#39;</span>

<span class="k">class</span> <span class="nc">Twipster</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">twitter</span><span class="p">)</span>
    <span class="c1"># A Ruby wrapper for the Twitter API</span>
    <span class="vi">@twitter</span> <span class="o">=</span> <span class="n">twitter</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
    <span class="vi">@twitter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">tweet</span><span class="si">}</span><span class="s2"> #lolhipster&quot;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">describe</span> <span class="no">Twipster</span><span class="p">,</span> <span class="s2">&quot;Make every tweet a hipster tweet.&quot;</span> <span class="k">do</span>
  <span class="n">before</span> <span class="k">do</span>
    <span class="vi">@twitter</span>  <span class="o">=</span> <span class="ss">MiniTest</span><span class="p">:</span><span class="ss">:Mock</span><span class="o">.</span><span class="n">new</span>
    <span class="vi">@twipster</span> <span class="o">=</span> <span class="no">Twipster</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@twitter</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s2">&quot;should append a #lolhipster hashtag and update Twitter with our status&quot;</span> <span class="k">do</span>
    <span class="n">tweet</span> <span class="o">=</span> <span class="s2">&quot;Skyrim? Too mainstream.&quot;</span>
    <span class="vi">@twitter</span><span class="o">.</span><span class="n">expect</span> <span class="ss">:update</span><span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="o">[</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">tweet</span><span class="si">}</span><span class="s2"> #lolhipster&quot;</span><span class="o">]</span>
    <span class="vi">@twipster</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
    <span class="n">assert</span> <span class="vi">@twitter</span><span class="o">.</span><span class="n">verify</span> <span class="c1"># verifies tweet and hashtag was passed to `@twitter.update`</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<h3>Resources</h3>

<ol>
<li><a href="https://github.com/seattlerb/minitest">MiniTest on Github</a></li>
<li><a href="http://docs.seattlerb.org/minitest">MiniTest Rdoc</a></li>
<li><a href="http://metaskills.net/2011/03/26/using-minitest-spec-with-rails">Using MiniTest::Spec with Rails</a></li>
<li><a href="http://www.rubyinside.com/a-minitestspec-tutorial-elegant-spec-style-testing-that-comes-with-ruby-5354.html">Ruby Inside: A MiniTest::Spec Tutorial: Elegant Spec-Style Testing That Comes With Ruby</a></li>
</ol>

<p>I hope you found this quick guide valuable. Please let me know if you&#39;d like
to see anything else included and feel free to ask questions or give feedback
in the comments section.</p>
        </div>
      </div>
    </article>
    <div class='ten column centered'>
      <div id='disqus_thread'></div>
      <script type='text/javascript'>
        //<![CDATA[
          var disqus_shortname = 'mattsears';
          var disqus_identifier = "/articles/2011/12/10/minitest-quick-reference";
          var disqus_url = "http://www.mattsears.com/articles/2011/12/10/minitest-quick-reference";
          
          (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
          }());
          
          // The following are highly recommended additional parameters. Remove the slashes in front to use.
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        //]]>
      </script>
      <noscript>
        Please enable JavaScript to view the
        <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
      </noscript>
    </div>
  </div>
</div>
        <section class='explore'>
          <div class='row'>
            <div class='ten columns centered'>
              <h5 class='text-center capitalize'>
                Explore articles from my blog
              </h5>
            </div>
          </div>
          <div class='row categories'>
            <div class='six columns text-center centered'>
              <ul class='no-bullet'>
                <li>
                  <a href='/articles/tags/git'>
                    Git
                  </a>
                </li>
                <li>
                  <a href='/articles/tags/ruby'>
                    Ruby
                  </a>
                </li>
                <li>
                  <a href='/articles/tags/clojure'>
                    Clojure
                  </a>
                </li>
                <li>
                  <a href='/articles/tags/rspec'>
                    Rspec
                  </a>
                </li>
                <li>
                  <a href='/articles/tags/minitest'>
                    Minitest
                  </a>
                </li>
                <li>
                  <a href='/articles'>Everything</a>
                </li>
              </ul>
            </div>
          </div>
          <div class='row'>
            <div class='six columns centered'>
              <form action='http://google.com/search' method='get'>
                <fieldset role='search'>
                  <input name='q' type='hidden' value='site:mattsears.com' />
                  <input class='search' name='q' placeholder='... or search this site (via Google)' results='0' type='text' />
                </fieldset>
              </form>
            </div>
          </div>
        </section>
        <section class='browse'>
          <div class='row'>
            <div class='ten columns centered'>
              <div class='row'>
                <div class='six mobile-four columns'>
                  <h5>
                    <b>
                      Popular:
                    </b>
                    The most visited articles:
                  </h5>
                  <hr />
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/12/10/minitest-quick-reference'>
                        Minitest Quick Reference
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/11/16/nyan-cat-rspec-formatter'>
                        Nyan Cat RSpec Formatter
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/11/27/ruby-blocks-as-dynamic-callbacks'>
                        Ruby Blocks as Dynamic Callbacks
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2009/06/06/20-clojure-links-to-get-you-up-to-speed'>
                        20 Clojure Links To Get You Up To Speed
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/10/12/gaga-key-value-store'>
                        Gaga, A Git-Backed Key/Value Store
                      </a>
                    </div>
                  </div>
                </div>
                <div class='six mobile-four columns'>
                  <h5>
                    <b>
                      New:
                    </b>
                    My most recent articles:
                  </h5>
                  <hr />
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/12/10/minitest-quick-reference'>
                        Minitest Quick Reference
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/11/27/ruby-blocks-as-dynamic-callbacks'>
                        Ruby Blocks as Dynamic Callbacks
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/11/16/nyan-cat-rspec-formatter'>
                        Nyan Cat RSpec Formatter
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/10/12/gaga-key-value-store'>
                        Gaga, A Git-Backed Key/Value Store
                      </a>
                    </div>
                  </div>
                  <hr />
                  <div class='row'>
                    <div class='nine columns cell'>
                      <a href='/articles/2011/05/15/print-stamps-with-ruby'>
                        Print Stamps With Ruby!
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <footer class='row text-center'>
          <div class='twelve columns'>
            <div class='row'>
              <div class='twelve columns'>
                <p>
                  You should follow me on
                  <a href='https://twitter.com/mattsears' rel='external'>Twitter</a>
                  and subscribe to
                  my
                  <a href='http://feeds.feedburner.com/mattsears'>RSS</a>
                  feed. Trust me.
                  <br />
                  Copyright Â© 2012 Matt Sears.
                </p>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        //
          var _gauges = _gauges || [];
          (function() {
            var t   = document.createElement('script');
            t.type  = 'text/javascript';
            t.async = true;
            t.id    = 'gauges-tracker';
            t.setAttribute('data-site-id', '4fb913d1f5a1f50be2000073');
            t.src = '//secure.gaug.es/track.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(t, s);
          })();
        //
      //]]>
    </script>
    <script src="/javascripts/all.js?1357088078" type="text/javascript"></script>
  </body>
</html>

